<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="static/img/f_logo.jpg">
  <link rel="icon" type="image/png" href="static/img/f_logo.jpg">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    POS Interface Monitoring
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
  <!-- CSS Files -->
  <link href="static/css/bootstrap.min.css" rel="stylesheet" />

  <link href="static/css/paper-dashboard.css?v=2.0.0" rel="stylesheet" />

   <!-- Material Design Bootstrap -->
   <link href="static/css/mdb.min.css" rel="stylesheet">

  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link href="static/demo/demo.css" rel="stylesheet" />
</head>

<body class="" >
  <div class="wrapper ">
    <div class="sidebar" data-color="white" data-active-color="danger">
      <!--
        Tip 1: You can change the color of the sidebar using: data-color="blue | green | orange | red | yellow"
    -->
      <div class="logo">
        <a href="http://www.fanslink.co.th/" class="simple-text logo-mini">
          <div class="logo-image-small">
            <img src="static/img/logo-small.png">
          </div>
        </a>
        <a href="http://www.fanslink.co.th/" class="simple-text logo-normal">
          Fanslink
          <!-- <div class="logo-image-big">
            <img src="../static/img/logo-big.png">
          </div> -->
        </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav">
          <li class="active ">
            <a href="/monitoring">
              <i class="nc-icon nc-tv-2"></i>
              <p>Monitoring</p>
            </a>
          </li>
 
          <li >
              <a href="/transaction">
                <i class="nc-icon nc-zoom-split"></i>
                <p>Transaction Viewer</p>
              </a>
            </li>

        </ul>
      </div>
    </div>
    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-absolute fixed-top navbar-transparent">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <div class="navbar-toggle">
              <button type="button" class="navbar-toggler">
                <span class="navbar-toggler-bar bar1"></span>
                <span class="navbar-toggler-bar bar2"></span>
                <span class="navbar-toggler-bar bar3"></span>
              </button>
            </div>
            <a class="navbar-brand" href="#pablo">POS Interface Monitoring</a>
          </div>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-bar navbar-kebab"></span>
            <span class="navbar-toggler-bar navbar-kebab"></span>
            <span class="navbar-toggler-bar navbar-kebab"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-end" id="navigation">
           
            
          </div>
        </div>
      </nav>
      <!-- End Navbar -->
      <!-- <div class="panel-header panel-header-lg">
  
  <canvas id="bigDashboardChart"></canvas>
  
  
</div> -->
      <!-- *************** Modal Setting Form ***************  -->
      <div class="modal fade" id="modalSettingForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
              <div class="modal-content">
                  <div class="modal-header text-center">
                      <h4 class="modal-title w-100 font-weight-bold">Setting</h4>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                      </button>
                  </div>
              
                  <div class="modal-body mx-3">

                      <div class="row">
                          <div class="col-4">
                              <div class="custom-control custom-radio">
                                  <input type="radio" class="custom-control-input" id="defaultGroupEvery" name="groupOfDefaultRadios" value="1" checked>
                                  <label class="custom-control-label" for="defaultGroupEvery">Every</label>
                              </div>
                          </div>
                          <div class="col-4">
                              <div class="md-form mb-5">
                                <input type="number" id="txtTime" class="form-control validate">
                                <label data-error="wrong" data-success="right" for="form29"></label>
                            </div>
                            </div>
                          <div class="col-4">
                              <select class="browser-default custom-select" id="ddlTimeType">
                                  <option selected></option>
                                  <option value="Second">Second</option>
                                  <option value="Minute">Minute</option>
                                  <option value="Hour">Hour</option>
                                </select>

                          </div>
                        </div>

                  
                        <div class="modal-footer d-flex justify-content-center">
                            <button class="btn btn-primary rounded" onclick="SettingSave();"  >Save <i class="fa fa-check ml-1"  ></i></button>							
                        </div>

                  </div>




              </div>
          </div>
      </div>

      <!-- *************** content ***************  -->  
      <div class="content">
        <div class="row">
          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-bullet-list-67 text-warning"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers">
                      <p class="card-category">Master Data</p>
                      <p class="text-info" id="MasterDataStatus" style="font-size: 0.55em;"><p>
                    

                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                    <a href="" data-toggle="modal" data-target="#modalSettingForm" data-whatever="MasterData" >
                  <i class="fa fa-gears"></i></a> Setting
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-money-coins text-success"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers">
                      <p class="card-category">Invoice/Payment</p>
                      <p class="text-info" id="PaymentStatus" style="font-size: 0.55em;"><p>
                      <!-- <p class="card-title">$ 1,345
                        <p> -->
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                    <a href="" data-toggle="modal" data-target="#modalSettingForm"  data-whatever="Invoice/Payment" >
                        <i class="fa fa-gears"></i></a> Setting
                </div>
              </div>
            </div>
          </div>
          

          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-cart-simple text-danger"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers">
                      <p class="card-category">Movement Request</p>
                      <p class="text-info" id="MovementRequestStatus" style="font-size: 0.55em;"><p>
                      <!-- <p class="card-title">23
                        <p> -->
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                    <a href="" data-toggle="modal" data-target="#modalSettingForm" data-whatever="MovementRequest">
                        <i class="fa fa-gears"></i></a> Setting
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-credit-card text-danger"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers">
                      <p class="card-category">MovementVerify</p>
                      <p class="text-info" id="MovementVRF" style="font-size: 0.55em;"><p>
                      <!-- <p class="card-title">$ 1,345
                        <p> -->
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                    <a href="" data-toggle="modal" data-target="#modalSettingForm"  data-whatever="MovementVRF" >
                        <i class="fa fa-gears"></i></a> Setting
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-delivery-fast text-danger"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers">
                      <p class="card-category">Movement</p>
                      <p class="text-info" id="MovementStatus" style="font-size: 0.55em;"><p>
                      <!-- <p class="card-title">23
                        <p> -->
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                    <a href="" data-toggle="modal" data-target="#modalSettingForm" data-whatever="Movement">
                        <i class="fa fa-gears"></i></a> Setting
                </div>
              </div>
            </div>
          </div>          

          <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card card-stats">
              <div class="card-body ">
                <div class="row">
                  <div class="col-5 col-md-4">
                    <div class="icon-big text-center icon-warning">
                      <i class="nc-icon nc-single-copy-04 text-primary"></i>
                    </div>
                  </div>
                  <div class="col-7 col-md-8">
                    <div class="numbers">
                      <p class="card-category">CN/DN</p>
                      <p class="text-info" id="CNDNStatus" style="font-size: 0.55em;"><p>
                      <!-- <p class="card-title">+45K
                        <p> -->
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-footer ">
                <hr>
                <div class="stats">
                    <a href="" data-toggle="modal" data-target="#modalSettingForm" data-whatever="CN/DN">
                        <i class="fa fa-gears"></i></a> Setting
						<!--<input type="text" id="ipMe" name="ipMe">-->
                </div>
              </div>
            </div>
          </div>
        </div>
        
      <footer class="footer footer-black  footer-white ">
        <div class="container-fluid">
          <div class="row">
            <nav class="footer-nav">
              <ul>
                <li>
                 
                </li>
                <li>
                  
                </li>
                <li>
                
                </li>
              </ul>
            </nav>
            <div class="credits ml-auto">
              <span class="copyright">
                ©
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </span>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>
  <!--   Core JS Files   -->
  <script src="static/js/core/jquery.min.js"></script>
  <script src="static/js/core/popper.min.js"></script>
  <script src="static/js/core/bootstrap.min.js"></script>
  <script src="static/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!--  Google Maps Plugin    -->
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
  <!-- Chart JS -->
  <script src="static/js/plugins/chartjs.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="static/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="static/js/paper-dashboard.min.js?v=2.0.0" type="text/javascript"></script>
  <!-- Paper Dashboard DEMO methods, don't include it in your project! -->
  <script src="static/demo/demo.js"></script>
 <!-- Bootstrap core JavaScript -->
 <script type="text/javascript" src="static/js/bootstrap.min.js"></script> 
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="static/js/mdb.min.js"></script>  

  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

  
  <script>
 
	
 
 
    var g_title = '';

    function SettingSave()
    {
    
      var ScheduleType = $("input[name='groupOfDefaultRadios']:checked").val();
      var ScheduleTime = $("input[id='txtTime']").val();
      //var ScheduleTimeType = document.getElementsByName("ddlTimeType")
      var ScheduleTimeType = $("#ddlTimeType option:selected" ).text();

      //console.log(ScheduleTimeType);

      $.ajax({
            type: "POST",
            url: "http://127.0.0.1:8081/SettingSave",
            // The key needs to match your method's input parameter (case-sensitive).
            data: JSON.stringify({ 
              "title": g_title,
              "ScheduleType": ScheduleType,
              "ScheduleTime": ScheduleTime,
              "ScheduleTimeType": ScheduleTimeType  
              }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            complete: function(res){
                //modal.find('.modal-title').text(res[0]["title"] + ' Setting');
                swal("Good job!", "You Setting Saved", "success");
              },
            failure: function(errMsg) {
                alert(errMsg);
            }
        });

    }
    g_title = '';
		//if (!window.EventSource) {
    $('#modalSettingForm').on('show.bs.modal', function (event) {
    var button = $(event.relatedTarget) // Button that triggered the modal
    var title = button.data('whatever') // Extract info from data-* attributes
    // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
    // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
    var modal = $(this)

    g_title = title
    //alert(g_title)
    //modal.find('.modal-title').text(title+' Setting')
      //$.getJSON('http://127.0.0.1:8081/SettingLoad'
      
      // $.post('http://127.0.0.1:8081/SettingLoad'
      // ,data: {'title': title}
      // ,function(res) {
      //           //alert(data["result"]);//do nothing
      //           modal.find('.modal-title').text(res["title"] + ' Setting');
      //           //modal.find('#txtTime').val(5);
      // },'json');
    //if (!!window.EventSource){
      //alert('xxx');
      $.ajax({
          type: "POST",
          url: "http://127.0.0.1:8081/SettingLoad",
          // The key needs to match your method's input parameter (case-sensitive).
          data: JSON.stringify({ title: title }),
          contentType: "application/json; charset=utf-8",
          dataType: "json",
          success: function(res){
              modal.find('.modal-title').text(res[0]["title"] + ' Setting');

              //Reset 
              modal.find('#txtTime').val("");
              modal.find('#ddlTimeType').val("");
              $('#defaultGroupEvery').prop('checked',true).click();

              rdScheType = res[2]["ScheduleType"]
              //alert(rdScheType)
              if(rdScheType == 1){
                $('#defaultGroupEvery').prop('checked',true).click();
              }else{
                $('#defaultGroupDaily').prop('checked',true).click();
              }


              modal.find('#txtTime').val(res[3]["ScheduleTime"]);
              modal.find('#ddlTimeType').val(res[4]["ScheduleTimeType"]);
           
    //var ScheduleTime = $("input[id='txtTime']").val();
    //var ScheduleTimeType = document.getElementsByName("ddlTimeType")
    //var ScheduleTimeType = $("#ddlTimeType option:selected" ).text();


              
            },             
          failure: function(errMsg) {
              alert(errMsg);
          }
      });
    //}
    //modal.find('.modal-body input').val(recipient)
  });
//}

//     $(document).ready(function() {

      
// //console.log(pc.onicecandidate);
//     });

    // var source = new EventSource("http://127.0.0.1:8081/progress");
    // source.onmessage = function(event) {
    //     $('.progress-bar').css('width', event.data+'%').attr('aria-valuenow', event.data);   
    // }
	
    function do_MasterDataStatus(){
      var sourceMasterData = new EventSource("http://127.0.0.1:8081/masterdata");
      sourceMasterData.onmessage = function(event) {
          //$('.progress-bar').css('width', event.data+'%').attr('aria-valuenow', event.data);   
          $('#MasterDataStatus').text(event.data);
          sourceMasterData.close();          
          do_PaymentStatus();
      }
    }
    //do_MasterDataStatus();
    //setTimeout(function(){ do_MasterDataStatus(); }, 3000);
    
    function do_PaymentStatus(){
      var sourcePayment = new EventSource("http://127.0.0.1:8081/payment");
      sourcePayment.onmessage = function(event) {
          //$('.progress-bar').css('width', event.data+'%').attr('aria-valuenow', event.data);   
          $('#PaymentStatus').text(event.data)
          sourcePayment.close();          
          do_MovementStatus();
      }
    }
    //do_PaymentStatus();
    //sourcePayment.close();
    function do_MovementStatus(){
      var sourceMovement = new EventSource("http://127.0.0.1:8081/movement");
      sourceMovement.onmessage = function(event) {
          //$('.progress-bar').css('width', event.data+'%').attr('aria-valuenow', event.data);   
          $('#MovementStatus').text(event.data);
          sourceMovement.close();
          do_MovementRequestStatus();
         
      }
    }
    //sourceMovement.close();
    function do_MovementRequestStatus(){
      var sourceMovementRequest = new EventSource("http://127.0.0.1:8081/movementrequest");
      sourceMovementRequest.onmessage = function(event) {
          //$('.progress-bar').css('width', event.data+'%').attr('aria-valuenow', event.data);   
          $('#MovementRequestStatus').text(event.data);
          sourceMovementRequest.close();
          do_MovementVRFStatus();
          // if (event.data == 'Error'){
          //   $("#InvoiceStatus").attr('class', 'text-danger');
          // }else{
          //   $("#InvoiceStatus").attr('class', 'text-info');
          // }
      }
    }
    //sourceMovementRequest.close();
    function do_MovementVRFStatus(){
      var MovementVRF = new EventSource("http://127.0.0.1:8081/MovementVRF");
      MovementVRF.onmessage = function(event) {
          //$('.progress-bar').css('width', event.data+'%').attr('aria-valuenow', event.data);   
          $('#MovementVRF').text(event.data);
          MovementVRF.close();    
          do_CNDNStatus();      
      }
    }
    //MovementVRF.close();
    function do_CNDNStatus(){
      var sourceCNDN = new EventSource("http://127.0.0.1:8081/cndn");
      sourceCNDN.onmessage = function(event) {
          //$('.progress-bar').css('width', event.data+'%').attr('aria-valuenow', event.data);   
          $('#CNDNStatus').text(event.data);
          sourceCNDN.close();
          setTimeout(function(){ do_MasterDataStatus(); }, 3000);
      }
    }

    setTimeout(function(){ do_MasterDataStatus(); }, 1000);
    //sourceCNDN.close();
    // setTimeout(function(){ sourceCNDN.close(); }, 3000);
    // setTimeout(function(){ MovementVRF.close(); }, 5000);
  </script>
</body>

</html>